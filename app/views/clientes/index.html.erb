<h1>Clientes</h1>

<div class="mb-3 d-flex justify-content-end">
  <%= link_to "Crear Nuevo Cliente", new_cliente_path, class: "btn btn-success" %>
</div>

<%= form_with url: clientes_path, method: :get, local: true, class: "mb-3" do |f| %>
  <div class="input-group">
    <%= f.text_field :q, value: params[:q], class: "form-control", placeholder: "Buscar clientes..." %>
    <button class="btn btn-primary">Buscar</button>
  </div>
<% end %>

<div class="table-responsive">
  <table class="table table-striped table-bordered align-middle">
    <thead class="table-light">
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Tipo</th>
      <th>Teléfono</th>
      <th>Email</th>
      <th>Dirección</th>
      <th>Creado</th>
      <th>Actualizado</th>
      <th>Acciones</th>
    </tr>
    </thead>

    <tbody>
    <% @clientes.each_with_index do |cliente, index| %>
      <tr>
        <td><%= index + 1 %></td>
        <td class="text-capitalize"><%= cliente.nombre %></td>
        <td><%= cliente.tipo %></td>
        <td><%= cliente.telefono.presence || '-' %></td>
        <td><%= cliente.email.presence || '-' %></td>
        <td><%= cliente.direccion.presence || '-' %></td>
        <td><%= cliente.created_at.strftime("%d/%m/%Y") if cliente.created_at %></td>
        <td><%= cliente.updated_at.strftime("%d/%m/%Y") if cliente.updated_at %></td>

        <td class="d-flex gap-1">
          <%= link_to edit_cliente_path(cliente),
                      class: "btn btn-sm btn-outline-primary",
                      title: "Editar cliente" do %>
            <i class="bi bi-pencil"></i>
          <% end %>

          <%= button_to cliente_path(cliente),
                        method: :delete,
                        data: { confirm: "¿Está seguro?" },
                        class: "btn btn-sm btn-outline-danger",
                        title: "Eliminar cliente" do %>
            <i class="bi bi-trash"></i>
          <% end %>
        </td>
      </tr>
    <% end %>

    <% if @clientes.empty? %>
      <tr>
        <td colspan="9" class="text-center">No hay clientes registrados.</td>
      </tr>
    <% end %>
    </tbody>
  </table>

  <%= paginate @clientes %>
</div>
