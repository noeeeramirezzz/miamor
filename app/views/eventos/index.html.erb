<h1>Eventos</h1>
<% if notice %>
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <%= notice %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% end %>

<div class="mb-3 d-flex justify-content-end">
  <%= link_to "Crear Nuevo Evento", new_evento_path, class: "btn btn-success" %>
</div>

<div class="table-responsive">
  <%= form_with url: eventos_path, method: :get, local: true, class: "mb-3" do |f| %>
    <div class="input-group">
      <%= f.text_field :q, value: params[:q], class: "form-control", placeholder: "Buscar eventos o clientes..." %>
      <button class="btn btn-primary">Buscar</button>
    </div>
  <% end %>

  <table class="table table-striped table-bordered align-middle">
    <thead class="table-light">
    <tr>
      <th>ID</th>
      <th>Cliente</th>
      <th>Nombre del Evento</th>
      <th>Tipo</th>
      <th>Fecha Inicio</th>
      <th>Fecha Fin</th>
      <th>Lugar</th>
      <th>Estado</th>
      <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <% @eventos.each_with_index do |evento, index| %>
      <tr>
        <td><%= index + 1 %></td>
        <td><%= evento.cliente&.nombre || "Sin cliente" %></td>
        <td><%= evento.nombre_evento %></td>
        <td><%= evento.tipo_evento %></td>
        <td><%= evento.fecha_inicio&.strftime("%d/%m/%Y %H:%M") %></td>
        <td><%= evento.fecha_fin&.strftime("%d/%m/%Y %H:%M") %></td>
        <td><%= evento.lugar %></td>
        <td><%= evento.estado %></td>
        <td class="d-flex gap-1">
          <%= link_to edit_evento_path(evento), class: "btn btn-sm btn-outline-primary", title: "Editar evento" do %>
            <i class="bi bi-pencil"></i>
          <% end %>
          <%= button_to evento_path(evento), method: :delete, data: { confirm: "¿Está seguro?" }, class: "btn btn-sm btn-outline-danger", title: "Eliminar evento" do %>
            <i class="bi bi-trash"></i>
          <% end %>
        </td>
      </tr>
    <% end %>
    <% if @eventos.empty? %>
      <tr>
        <td colspan="9" class="text-center">No hay eventos registrados.</td>
      </tr>
    <% end %>
    </tbody>
  </table>
  <%= paginate @eventos %>
</div>
